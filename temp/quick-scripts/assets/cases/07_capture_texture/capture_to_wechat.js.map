{"version":3,"sources":["capture_to_wechat.js"],"names":["cc","Class","extends","require","start","init","scheduleOnce","canvas","createCanvas","createImg","saveFile","tempCanvas","sys","platform","WECHAT_GAME","self","data","x","y","width","height","destWidth","destHeight","fileType","quality","_tempFilePath","toTempFilePathSync","log","label","string","wx","previewImage","urls","success","res"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASC,QAAQ,sBAAR,CADJ;;AAGLC,SAHK,mBAGI;AAAA;;AACL,aAAKC,IAAL;AACA;AACA,aAAKC,YAAL,CAAkB,YAAM;AACpB,gBAAIC,SAAS,MAAKC,YAAL,EAAb;AACA,kBAAKC,SAAL;AACA,kBAAKC,QAAL,CAAcH,MAAd;AACH,SAJD,EAIG,CAJH;AAKH,KAXI;AAaLG,YAbK,oBAaKC,UAbL,EAaiB;AAClB;AACA,YAAIX,GAAGY,GAAH,CAAOC,QAAP,KAAoBb,GAAGY,GAAH,CAAOE,WAA/B,EAA4C;AACxC,gBAAIC,OAAO,IAAX;AACA,gBAAIC,OAAO;AACPC,mBAAG,CADI;AAEPC,mBAAG,CAFI;AAGPC,uBAAOZ,OAAOY,KAHP;AAIPC,wBAAQb,OAAOa,MAJR;AAKP;AACAC,2BAAWd,OAAOY,KANX;AAOPG,4BAAYf,OAAOa,MAPZ;AAQPG,0BAAU,KARH;AASPC,yBAAS;AAEb;AAXW,aAAX,CAYA,IAAIC,gBAAgBd,WAAWe,kBAAX,CAA8BV,IAA9B,CAApB;AACAhB,eAAG2B,GAAH,2BAA+BF,aAA/B;AACAV,iBAAKa,KAAL,CAAWC,MAAX,GAAoB,eAApB;AACA;AACAC,eAAGC,YAAH,CAAgB;AACZC,sBAAM,CAACP,aAAD,CADM;AAEZQ,yBAAS,iBAACC,GAAD,EAAS;AACdlC,uBAAG2B,GAAH,CAAO,wBAAP;AACAZ,yBAAKa,KAAL,CAAWC,MAAX,GAAoB,EAApB;AACH;AALW,aAAhB;AAOH,SAzBD,MA0BK;AACD,gBAAId,QAAO,IAAX;AACAA,kBAAKa,KAAL,CAAWC,MAAX,GAAoB,eAApB;AACA7B,eAAG2B,GAAH,CAAO,eAAP;AACH;AACJ;AA9CI,CAAT","file":"capture_to_wechat.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\cases\\07_capture_texture","sourcesContent":["cc.Class({\n    extends: require('./textureRenderUtils'),\n\n    start () {\n        this.init();\n        // create the capture\n        this.scheduleOnce(() => {\n            let canvas = this.createCanvas();\n            this.createImg();\n            this.saveFile(canvas);\n        }, 1);\n    },\n\n    saveFile (tempCanvas) {\n        // This is one of the ways that could save the img to your local.\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            let self = this;\n            let data = {\n                x: 0,\n                y: 0,\n                width: canvas.width,\n                height: canvas.height,\n                // destination file sizes\n                destWidth: canvas.width,\n                destHeight: canvas.height,\n                fileType: 'png',\n                quality: 1\n            }\n            // https://developers.weixin.qq.com/minigame/dev/api/render/canvas/Canvas.toTempFilePathSync.html\n            let _tempFilePath = tempCanvas.toTempFilePathSync(data);\n            cc.log(`Capture file success!${_tempFilePath}`);\n            self.label.string = '图片加载完成，等待本地预览';\n            // https://developers.weixin.qq.com/minigame/dev/api/media/image/wx.previewImage.html\n            wx.previewImage({\n                urls: [_tempFilePath],\n                success: (res) => {\n                    cc.log('Preview image success.');\n                    self.label.string = '';\n                }\n            });\n        }\n        else {\n            let self = this;\n            self.label.string = '该样例只支持微信小游戏平台';\n            cc.log('该样例只支持微信小游戏平台');\n        }\n    }\n});\n"]}