{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\cases\\05_scripting\\07_asset_loading\\LoadResDir/assets\\cases\\05_scripting\\07_asset_loading\\LoadResDir\\loadResDir_example.js"],"names":["cc","Class","extends","Component","properties","btnClearAll","Node","label","Prefab","scrollView","ScrollView","_init","_assets","_hasLoading","content","height","active","onLoad","_createLabel","text","node","instantiate","getComponent","Label","textKey","addChild","_clear","removeAllChildren","i","length","asset","deps","loader","getDependsRecursively","release","onClearAll","onLoadAll","scrollToTop","loadResDir","err","assets","isValid","info","toString","JsonAsset","JSON","stringify","json","name","js","getClassName","onLoadSpriteFrameAll","SpriteFrame"],"mappings":"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","file":"loadResDir_example.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\cases\\05_scripting\\07_asset_loading\\LoadResDir","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnClearAll: cc.Node,\n        label: cc.Prefab,\n        scrollView: cc.ScrollView\n    },\n\n    _init: function () {\n        this._assets = [];\n        this._hasLoading = false;\n        this.scrollView.content.height = 0;\n        this.btnClearAll.active = false;\n    },\n\n    onLoad: function () {\n        this._init();\n    },\n\n    _createLabel: function (text) {\n        var node = cc.instantiate(this.label);\n        var label = node.getComponent(cc.Label);\n        label.textKey = text;\n        this.scrollView.content.addChild(node);\n    },\n\n    _clear: function () {\n        this.scrollView.content.removeAllChildren(true);\n        for (var i = 0; i < this._assets.length; ++i) {\n            var asset = this._assets[i];\n            // 需要释放所有资源依赖\n            var deps = cc.loader.getDependsRecursively(asset);\n            cc.loader.release(deps);\n        }\n    },\n\n    onClearAll: function () {\n        this.scrollView.content.height = 0;\n        this.btnClearAll.active = false;\n        this._clear();\n    },\n\n    onLoadAll: function () {\n        if (this._hasLoading) { return; }\n        this._hasLoading = true;\n\n        this._clear();\n        this._createLabel(\"Load All Assets\");\n        this.scrollView.scrollToTop();\n        this.btnClearAll.active = false;  // 防止加载的过程中清除资源\n\n        cc.loader.loadResDir(\"test_assets\", (err, assets) => {\n            if (!this.isValid) {\n                return;\n            }\n\n            this._assets = assets;\n            for (var i = 0; i < assets.length; ++i) {\n                var asset = assets[i];\n                var info = asset.toString();\n                if (!info) {\n                    if (asset instanceof cc.JsonAsset) {\n                        info = JSON.stringify(asset.json, null, 4);\n                    }\n                    else {\n                        info = info || asset.name || cc.js.getClassName(asset);\n                    }\n                }\n                this._createLabel(info);\n            }\n            this._hasLoading = false;\n            this.btnClearAll.active = true;\n        });\n    },\n\n    onLoadSpriteFrameAll: function () {\n        if (this._hasLoading) { return; }\n        this._hasLoading = true;\n\n        this._clear();\n        this._createLabel(\"Load All Sprite Frame\");\n        this.scrollView.scrollToTop();\n        this.btnClearAll.active = false;  // 防止加载的过程中清除资源\n\n        cc.loader.loadResDir(\"test_assets\", cc.SpriteFrame, (err, assets) => {\n            if (!this.isValid) {\n                return;\n            }\n            this._assets = assets;\n            for (var i = 0; i < assets.length; ++i) {\n                var asset = assets[i];\n                this._createLabel(asset.name);\n            }\n            this._hasLoading = false;\n            this.btnClearAll.active = true;\n        });\n    }\n});\n"]}